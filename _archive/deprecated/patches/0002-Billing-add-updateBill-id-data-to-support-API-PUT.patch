From 0e4cec6860e7a0ca590ad75bd3bbc33d875beb7d Mon Sep 17 00:00:00 2001
From: AI Assistant <assistant@example.com>
Date: Sat, 29 Nov 2025 23:32:19 +0530
Subject: [PATCH 2/3] Billing: add updateBill(id, data) to support API PUT

---
 classes/Billing.php | 28 +++++++++++++++++++++++++---
 1 file changed, 25 insertions(+), 3 deletions(-)

diff --git a/classes/Billing.php b/classes/Billing.php
index 7aaf76d..6c82bd8 100644
--- a/classes/Billing.php
+++ b/classes/Billing.php
@@ -316,10 +316,32 @@ class Billing {
         }
     }
 
+    // Update a bill with new data. Returns boolean.
+    public function updateBill($id, $data) {
+        if (empty($id)) {
+            return false;
+        }
+
+        try {
+            $query = "UPDATE billing SET patient_id = :patient_id, appointment_id = :appointment_id, 
+                     due_date = :due_date, total_amount = :total_amount, notes = :notes WHERE id = :id";
+            $stmt = $this->conn->prepare($query);
+            $stmt->bindParam(':patient_id', $data['patient_id'] ?? null);
+            $stmt->bindParam(':appointment_id', $data['appointment_id'] ?? null);
+            $stmt->bindParam(':due_date', $data['due_date'] ?? null);
+            $stmt->bindParam(':total_amount', $data['total_amount'] ?? 0);
+            $stmt->bindParam(':notes', $data['notes'] ?? null);
+            $stmt->bindParam(':id', $id);
+            return $stmt->execute();
+        } catch (PDOException $e) {
+            return false;
+        }
+    }
+
     // Backwards-compatible wrapper expected by API
-+    public function getBillById($id) {
-+        return $this->getBill($id);
-+    }
+    public function getBillById($id) {
+        return $this->getBill($id);
+    }
 +
 +    // Delete a bill by numeric id or bill_number (string). Returns boolean.
 +    public function deleteBill($id) {
-- 
2.51.1.windows.1

